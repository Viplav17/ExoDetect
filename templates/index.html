<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>ExoDetect</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#0a0f18;--text:#eef2f7;--muted:#c6d0e1;--accent:#77e1ff;--radius-xl:28px;--radius-pill:9999px;--shadow-soft:0 10px 40px rgba(0,0,0,0.35);--maxw:1040px}
        *{box-sizing:border-box}
        html,body{margin:0;padding:0;background:transparent;color:var(--text);font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;scroll-behavior:smooth}
        
        .main-nav{position:fixed;top:0;left:0;right:0;z-index:100;display:flex;justify-content:space-between;align-items:center;padding:18px clamp(16px, 4vw, 40px);background:linear-gradient(180deg, rgba(10,15,24,0.85) 0%, rgba(10,15,24,0) 100%);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}
        .nav-brand{font-family:'Playfair Display',serif;font-weight:700;font-size:22px;text-decoration:none;color:var(--text)}
        .nav-links{display:flex;gap:24px}
        .nav-links a{text-decoration:none;color:var(--muted);font-weight:500;transition:color .2s ease}
        .nav-links a:hover{color:var(--accent)}

        .hero{position:relative;min-height:100svh;display:grid;place-items:center;overflow:hidden;background:transparent}
        .video-zoom-wrap{position:fixed;inset:0;z-index:-1;overflow:hidden}
        .video-zoom-wrap video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(1.1) saturate(1.1) contrast(1.05)}
        
        .hero::after{content:"";position:absolute;inset:0;background:radial-gradient(120% 120% at 50% 10%,rgba(0,0,0,0.05) 0%,rgba(0,0,0,0.26) 55%,rgba(0,0,0,0.42) 100%);pointer-events:none}
        .hero-content{position:relative;z-index:1;width:min(92vw, var(--maxw));text-align:center;padding:clamp(16px, 3vw, 24px)}

        .brand{font-family:'Playfair Display',serif;letter-spacing:.4px;font-weight:700;font-size:clamp(38px, 6.2vw, 66px);line-height:1.1;margin:0 0 10px 0;background:linear-gradient(120deg, #ffffff, var(--accent));-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 2px 18px rgba(0,0,0,0.35);--w:0%;background-size:200% 100%;-webkit-mask-image:linear-gradient(90deg, #000 0 calc(var(--w) - 1%), transparent calc(var(--w)), transparent 100%);mask-image:linear-gradient(90deg, #000 0 calc(var(--w) - 1%), transparent calc(var(--w)), transparent 100%);animation:typeMask 2s steps(28, end) forwards, shine 6s ease-in-out infinite}
        @keyframes typeMask{from{--w:0%}to{--w:100%}}
        @keyframes shine{0%,100%{background-position:0% 0}50%{background-position:100% 0}}
        
        .tagline{color:var(--muted);font-size:clamp(16px, 2.2vw, 20px);margin:0 auto;max-width:820px;text-shadow:0 2px 14px rgba(0,0,0,0.35);animation:fadeIn 900ms 300ms ease both}
        @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}
        
        .cta-row{margin-top:22px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap;animation:fadeIn 900ms 500ms ease both}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;text-decoration:none;cursor:pointer;padding:14px 22px;border:1px solid rgba(255,255,255,0.20);background:linear-gradient(180deg, rgba(255,255,255,0.24), rgba(255,255,255,0.12));color:#fff;border-radius:var(--radius-pill);box-shadow:var(--shadow-soft);transition:transform .2s ease, filter .2s ease, background .2s ease;font-weight:600}
        .btn:hover{transform:translateY(-2px);filter:brightness(1.05)}
        .btn-accent{background:linear-gradient(180deg, rgba(119,225,255,0.88), rgba(119,225,255,0.48));border-color:rgba(119,225,255,0.65);animation:pulse 2.5s infinite}
        .arrow-down{font-weight:700;font-size:1.3em;line-height:1}
        @keyframes pulse{0%{transform:scale(1);box-shadow:var(--shadow-soft)}50%{transform:scale(1.03);box-shadow:0 12px 50px rgba(119, 225, 255, 0.3)}100%{transform:scale(1);box-shadow:var(--shadow-soft)}}

        .section{scroll-margin-top:16px;padding:clamp(32px, 6vw, 80px) 16px;display:grid;place-items:center;position:relative;overflow:hidden}
        .starry{background-color:#0e1522;background-image:url('/static/Sky-Background.jpeg');background-repeat:no-repeat;background-size:cover;background-attachment:scroll}
        
        .card{position:relative;z-index:1;width:min(92vw, var(--maxw));background:rgba(14, 18, 28, 0.62);border:1px solid rgba(255,255,255,0.16);border-radius:var(--radius-xl);box-shadow:var(--shadow-soft);padding:clamp(20px, 4vw, 36px);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px)}
        .card h2{font-family:'Playfair Display',serif;font-size:clamp(24px, 3.6vw, 36px);margin:0 0 8px 0;letter-spacing:0.3px}
        .card p{margin:0 0 18px 0;color:var(--muted)}
        .form-row{display:flex;flex-wrap:wrap;align-items:center;gap:12px;margin-top:8px}
        .select{appearance:none;-webkit-appearance:none;padding:14px 18px;border-radius:var(--radius-pill);border:1px solid rgba(255,255,255,0.32);background-color:rgba(8,14,22,0.94);color:#fff;min-width:240px;font-weight:700;box-shadow:var(--shadow-soft);color-scheme:dark;background-image:linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.05)), url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 20 20" fill="white"><path d="M5.5 7.5l4.5 5 4.5-5" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>');background-repeat:no-repeat, no-repeat;background-position:0 0, right 14px center;padding-right:44px}
        .select:focus{outline:none;box-shadow:0 0 0 4px rgba(119,225,255,0.28)}
        .select option{background-color:#0d1722;color:#fff}
        .muted-note{color:var(--muted);font-size:0.95rem;margin-top:10px}
        .btn-ghost{background:linear-gradient(180deg, rgba(255,255,255,0.18), rgba(255,255,255,0.08));border:1px solid rgba(255,255,255,0.22);color:#fff}
        #data .grid{width:min(92vw, var(--maxw));display:grid;gap:16px}
        .panel{position:relative;z-index:1;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.12);border-radius:var(--radius-xl);box-shadow:var(--shadow-soft);padding:clamp(16px, 3.6vw, 28px);backdrop-filter:blur(6px);animation:fadeIn 500ms ease both}
        .panel h3{margin:0 0 8px 0;font-family:'Playfair Display',serif;letter-spacing:.3px;font-size:clamp(20px, 3.4vw, 30px)}
        .hidden{display:none !important}
        .form-grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:20px;margin-top:24px}
        .form-grid > div{display:flex;flex-direction:column}
        .form-grid label{font-size:0.9rem;font-weight:500;color:var(--muted);margin-bottom:6px}
        .form-grid input{padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.32);background-color:rgba(8,14,22,0.94);color:#fff;font-weight:500;box-shadow:var(--shadow-soft)}
        .form-grid input:focus{outline:none;box-shadow:0 0 0 4px rgba(119,225,255,0.28)}
        .result-panel{margin-top:24px;padding:20px;border-radius:12px;border:1px solid;text-align:center}
        .result-panel h4{margin:0 0 8px 0;font-size:24px;font-family:'Playfair Display',serif}
        .result-panel p{color:var(--text);margin:0}
        .result-true{border-color:#2ac8a0;background:rgba(42,200,160,0.1)}
        .result-false{border-color:#ff6b6b;background:rgba(255,107,107,0.1)}
        .stats-grid{margin-top:28px;display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;text-align:center}
        .stats-grid > div{padding:16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px}
        .stats-grid h4{margin:0 0 4px 0;color:var(--muted);font-weight:500}
        .stats-grid .stat{font-size:1.5rem;font-weight:700;margin:0;color:var(--text)}
        .modal-overlay{position:fixed;inset:0;background:rgba(10, 15, 24, 0.8);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);z-index:200;display:grid;place-items:center;opacity:0;transition:opacity .3s ease;pointer-events:none}
        .modal-overlay:not(.hidden){opacity:1;pointer-events:auto}
        .modal-card{width:min(90vw, 500px);background:var(--bg);border:1px solid rgba(255,255,255,0.16);border-radius:var(--radius-xl);box-shadow:var(--shadow-soft);padding:clamp(20px, 4vw, 36px);text-align:center}
        .modal-card h3{font-family:'Playfair Display',serif;font-size:clamp(22px, 3.4vw, 32px);margin:0 0 8px 0}
        .modal-card p{color:var(--muted);margin-bottom:24px}
        .modal-buttons{display:flex;justify-content:center;gap:12px}
        
        .archive-result-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 16px; margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255, 255, 255, 0.1); text-align: left; }
        .archive-result-grid .item { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 8px; }
        .archive-result-grid .key { font-size: 0.8rem; font-weight: 600; color: var(--muted); display: block; margin-bottom: 4px; word-break: break-all; }
        .archive-result-grid .value { font-size: 1rem; font-weight: 500; color: var(--text); word-break: break-all; }

        .footer { padding: 40px 16px; text-align: center; color: var(--muted); font-size: 0.9rem; background-color: #0a0f18; border-top: 1px solid rgba(255,255,255,0.1); }
        .footer p { margin: 0 0 8px 0; }
        .footer .credits { font-weight: 600; color: var(--text); }

        @media (prefers-reduced-motion: reduce){.brand,.tagline,.cta-row,.panel,.btn-accent{animation:none}}
    </style>
</head>
<body>

<header class="hero" id="home">
    <div class="video-zoom-wrap">
        <video id="bgVid" autoplay muted playsinline preload="auto">
            <source src="/static/galaxy_reverse.mp4" type="video/mp4">
        </video>
    </div>
    <div class="hero-content">
        <h1 class="brand">ExoDetect</h1>
        <p class="tagline">A calm, elegant toolkit for discovering worlds beyond our Sun—bringing researchers a neat, focused path from mission selection to data exploration.</p>
        <div class="cta-row">
            <a href="#console" class="btn btn-accent">Start Exploring <span class="arrow-down">↓</span></a>
        </div>
    </div>
</header>

<nav class="main-nav">
    <a href="#home" class="nav-brand">ExoDetect</a>
    <div class="nav-links">
        <a href="#console">Console</a>
        <a href="#data">Workspace</a>
        <a href="#science">The Science</a>
        <a href="#archive">Data Archive</a>
    </div>
</nav>

<section class="section starry" id="console">
    <div class="card" aria-labelledby="consoleTitle">
        <h2 id="consoleTitle">Researcher Console</h2>
        <p>Select your mission, then jump to the data workspace below.</p>
        <div class="form-row" role="group" aria-label="Mission selection">
            <label for="mission" class="sr-only">Mission</label>
            <select id="mission" class="select" aria-label="Choose a mission">
                <option value="" selected disabled>Choose a mission…</option>
                <option value="kepler">Kepler</option>
                <option value="tess">TESS</option>
                <option value="k2">K2</option>
            </select>
            <a id="goData" class="btn btn-ghost" href="#data">Go to Data →</a>
        </div>
        <p class="muted-note" id="missionNote">No mission selected yet.</p>
    </div>
</section>

<section class="section starry" id="data" aria-labelledby="dataTitle">
    <div class="grid">
        <div class="panel">
            <div class="form-row" style="justify-content: space-between;">
                <h2 id="dataTitle" style="margin:0;">Data Workspace</h2>
                <a class="btn btn-ghost" href="#console">⬅ Back to Console</a>
            </div>
            <p class="muted">Your selected mission’s panels appear below.</p>
        </div>
        <div id="panel-kepler" class="panel hidden" aria-live="polite">
            <h3>Kepler Candidate Input</h3>
            <p class="muted">Enter the observational data for your Kepler Object of Interest (KOI). All fields are required for an accurate prediction.</p>
            <form id="kepler-form">
                <div class="form-grid">
                    <div><label for="koi_fpflag_nt">Not Transit-Like Flag</label><input type="number" id="koi_fpflag_nt" name="koi_fpflag_nt" value="0" required></div>
                    <div><label for="koi_fpflag_ss">Stellar Variability Flag</label><input type="number" id="koi_fpflag_ss" name="koi_fpflag_ss" value="0" required></div>
                    <div><label for="koi_fpflag_co">Centroid Offset Flag</label><input type="number" id="koi_fpflag_co" name="koi_fpflag_co" value="0" required></div>
                    <div><label for="koi_fpflag_ec">Eclipsing Binary Flag</label><input type="number" id="koi_fpflag_ec" name="koi_fpflag_ec" value="0" required></div>
                    <div><label for="koi_period">Orbital Period [days]</label><input type="number" step="any" id="koi_period" name="koi_period" placeholder="e.g., 9.488" required></div>
                    <div><label for="koi_time0bk">Transit Epoch [BJD-2454833]</label><input type="number" step="any" id="koi_time0bk" name="koi_time0bk" placeholder="e.g., 170.538" required></div>
                    <div><label for="koi_impact">Impact Parameter</label><input type="number" step="any" id="koi_impact" name="koi_impact" placeholder="e.g., 0.146" required></div>
                    <div><label for="koi_duration">Transit Duration [hours]</label><input type="number" step="any" id="koi_duration" name="koi_duration" placeholder="e.g., 2.957" required></div>
                    <div><label for="koi_depth">Transit Depth [ppm]</label><input type="number" step="any" id="koi_depth" name="koi_depth" placeholder="e.g., 615.8" required></div>
                    <div><label for="koi_prad">Planetary Radius [Earth radii]</label><input type="number" step="any" id="koi_prad" name="koi_prad" placeholder="e.g., 2.26" required></div>
                    <div><label for="koi_teq">Equilibrium Temperature [K]</label><input type="number" id="koi_teq" name="koi_teq" placeholder="e.g., 793" required></div>
                    <div><label for="koi_insol">Insolation Flux [Earth flux]</label><input type="number" step="any" id="koi_insol" name="koi_insol" placeholder="e.g., 93.59" required></div>
                    <div><label for="koi_model_snr">Transit Signal-to-Noise</label><input type="number" step="any" id="koi_model_snr" name="koi_model_snr" placeholder="e.g., 35.8" required></div>
                    <div><label for="koi_steff">Stellar Effective Temp [K]</label><input type="number" id="koi_steff" name="koi_steff" placeholder="e.g., 5455" required></div>
                    <div><label for="koi_slogg">Stellar Surface Gravity</label><input type="number" step="any" id="koi_slogg" name="koi_slogg" placeholder="e.g., 4.467" required></div>
                    <div><label for="koi_srad">Stellar Radius [Solar radii]</label><input type="number" step="any" id="koi_srad" name="koi_srad" placeholder="e.g., 0.927" required></div>
                    <div><label for="ra">RA [decimal degrees]</label><input type="number" step="any" id="ra" name="ra" placeholder="e.g., 291.934" required></div>
                    <div><label for="dec">Dec [decimal degrees]</label><input type="number" step="any" id="dec" name="dec" placeholder="e.g., 48.141" required></div>
                    <div><label for="koi_kepmag">Kepler-band Magnitude</label><input type="number" step="any" id="koi_kepmag" name="koi_kepmag" placeholder="e.g., 15.347" required></div>
                    <input type="hidden" id="koi_tce_plnt_num" name="koi_tce_plnt_num" value="1.0">
                </div>
                <button type="submit" class="btn btn-accent" style="margin-top: 24px;">Analyze Candidate</button>
            </form>
            <div id="prediction-result" class="result-panel hidden"></div>
        </div>
        <div id="panel-tess" class="panel hidden" aria-live="polite"><h3>TESS Overview</h3><p class="muted">TESS surveys nearly the whole sky... </p></div>
        <div id="panel-k2" class="panel hidden" aria-live="polite"><h3>K2 Overview</h3><p class="muted">K2 extended Kepler’s mission... </p></div>
    </div>
</section>

<section class="section starry" id="archive">
    <div class="card" aria-labelledby="archiveTitle">
        <h2 id="archiveTitle">Data Archive Search</h2>
        <p>Look up a specific Kepler Object of Interest (KOI) from the original, uncleaned dataset by its name (e.g., "K00752.01") or Kepler ID (e.g., "10797460").</p>
        <form id="archive-form">
            <div class="form-row">
                <input type="text" id="archive-query" class="select" placeholder="Enter KOI Name or Kepler ID..." required style="flex-grow: 1;">
                <button type="submit" class="btn btn-accent">Search Archive</button>
            </div>
        </form>
        <div id="archive-result" class="hidden" style="margin-top: 24px;"></div>
        <!-- This is the new "Done" button, initially hidden -->
        <button id="archive-done-btn" class="btn btn-ghost hidden" style="margin-top: 20px; width: 100%;">Done</button>
    </div>
</section>

<section class="section starry" id="science">
    <div class="card" aria-labelledby="scienceTitle">
        <h2 id="scienceTitle">The Science of Detection</h2>
        <p>Our models are trained on verified data... </p>
        <div class="stats-grid">
            <div><h4>Model Accuracy</h4><p class="stat">99.6%</p></div>
            <div><h4>Method</h4><p class="stat">Transit Photometry</p></div>
            <div><h4>Primary Dataset</h4><p class="stat">Kepler DR25</p></div>
        </div>
    </div>
</section>

<footer class="footer">
    <p>A project by <span class="credits">Viplav Nagpal, Romila Gholse, and Eeesha Madan</span></p>
    <p>October 2025</p>
</footer>

<div id="confirmation-modal" class="modal-overlay hidden">
    <div class="modal-card">
        <h3>Confirm Submission</h3>
        <p>Is the candidate data you entered correct and ready for analysis?</p>
        <div class="modal-buttons">
            <button id="confirm-no" class="btn btn-ghost">Go Back & Edit</button>
            <button id="confirm-yes" class="btn btn-accent">Yes, Analyze</button>
        </div>
    </div>
</div>

<script>
    const missionEl = document.getElementById('mission');
    const goData = document.getElementById('goData');
    const missionNote = document.getElementById('missionNote');
    const panels = { kepler: document.getElementById('panel-kepler'), tess: document.getElementById('panel-tess'), k2: document.getElementById('panel-k2') };
    function showPanel(mission) {
      Object.entries(panels).forEach(([key, el]) => { el.classList.toggle('hidden', key !== mission) });
      const pretty = mission === 'kepler' ? 'Kepler' : mission === 'tess' ? 'TESS' : 'K2';
      document.getElementById('dataTitle').textContent = `${pretty} • Data Workspace`;
    }
    missionEl.addEventListener('change', () => { missionNote.textContent = `Mission selected: ${missionEl.value.toUpperCase()}` });
    goData.addEventListener('click', (e) => {
      const val = missionEl.value;
      if (!val) {
        e.preventDefault();
        goData.animate([{ transform: 'translateY(0)' }, { transform: 'translateY(-2px)' }, { transform: 'translateY(0)' }], { duration: 250 });
        missionNote.textContent = 'Please choose Kepler, TESS, or K2 first.';
        return;
      }
      requestAnimationFrame(() => showPanel(val));
    });

    const keplerForm = document.getElementById('kepler-form');
    const resultPanel = document.getElementById('prediction-result');
    const confirmationModal = document.getElementById('confirmation-modal');
    const confirmYesBtn = document.getElementById('confirm-yes');
    const confirmNoBtn = document.getElementById('confirm-no');
    keplerForm.addEventListener('submit', function(event) {
      event.preventDefault();
      confirmationModal.classList.remove('hidden');
    });
    confirmYesBtn.addEventListener('click', function() {
      confirmationModal.classList.add('hidden');
      resultPanel.classList.remove('hidden', 'result-true', 'result-false');
      resultPanel.innerHTML = '<p>Analyzing candidate... Please wait.</p>';
      const formData = new FormData(keplerForm);
      fetch('/predict', { method: 'POST', body: formData })
      .then(response => response.json())
      .then(data => {
        if (data.error) {
          displayResult(false, 'Error', `An error occurred: ${data.error}`);
        } else {
          const isPlanet = data.prediction === 1;
          const resultText = isPlanet ? 'Likely Planet Candidate' : 'Likely False Positive';
          const description = `The model is ${data.confidence}% confident in this classification.`;
          displayResult(isPlanet, resultText, description);
        }
      })
      .catch(error => { console.error('Error:', error); displayResult(false, 'Network Error', 'Could not connect to the analysis server.'); });
    });
    function closeModal() { confirmationModal.classList.add('hidden'); }
    confirmNoBtn.addEventListener('click', closeModal);
    confirmationModal.addEventListener('click', function(event) { if (event.target === confirmationModal) { closeModal(); } });
    function displayResult(isPlanet, title, description) {
      resultPanel.classList.remove('hidden');
      resultPanel.classList.toggle('result-true', isPlanet);
      resultPanel.classList.toggle('result-false', !isPlanet);
      resultPanel.innerHTML = `<h4>${title}</h4><p>${description}</p>`;
    }

    const archiveForm = document.getElementById('archive-form');
    const archiveQueryInput = document.getElementById('archive-query');
    const archiveResultDiv = document.getElementById('archive-result');
    const archiveDoneBtn = document.getElementById('archive-done-btn');

    if (archiveForm) {
        archiveForm.addEventListener('submit', function(event) {
            event.preventDefault();
            
            archiveResultDiv.classList.remove('hidden');
            archiveResultDiv.innerHTML = `<p>Searching the archive...</p>`;
            if (archiveDoneBtn) archiveDoneBtn.classList.add('hidden');

            const formData = new FormData();
            formData.append('query', archiveQueryInput.value);

            fetch('/search_archive', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    archiveResultDiv.innerHTML = `<p style="color: var(--accent);">${data.error}</p>`;
                } else {
                    let resultHTML = '<div class="archive-result-grid">';
                    for (const [key, value] of Object.entries(data)) {
                        if (value !== '') {
                            resultHTML += `
                                <div class="item">
                                    <span class="key">${key}</span>
                                    <span class="value">${value}</span>
                                </div>
                            `;
                        }
                    }
                    resultHTML += '</div>';
                    archiveResultDiv.innerHTML = resultHTML;
                    if (archiveDoneBtn) archiveDoneBtn.classList.remove('hidden');
                }
            })
            .catch(error => {
                console.error('Archive Search Error:', error);
                archiveResultDiv.innerHTML = `<p style="color: var(--accent);">An error occurred while searching.</p>`;
            });
        });
    }

    if (archiveDoneBtn) {
        archiveDoneBtn.addEventListener('click', () => {
            archiveResultDiv.classList.add('hidden');
            archiveDoneBtn.classList.add('hidden');
            archiveQueryInput.value = '';
        });
    }
</script>

</body>
</html>

